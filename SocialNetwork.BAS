DECLARE SUB REGISTER
DECLARE SUB LOGIN
DECLARE SUB HOME
DECLARE SUB POST
DECLARE SUB MESSAGE
DECLARE SUB SEARCH
DECLARE SUB ABOUT
DECLARE SUB SETTINGS


CLS
DO
    CLS
    COLOR 2
    LOCATE 5, 15: PRINT "   REGISTER(R)                      "
    LOCATE 7, 15: PRINT "                                "
    LOCATE 8, 15: PRINT "   LOGIN(L)                       "
    LOCATE 9, 15: PRINT "                                 "
    LOCATE 10, 15: PRINT "   ABOUT(A)                      "
    LOCATE 13, 15: PRINT "                                 "
    LOCATE 15, 15: PRINT "   EXIT(E)                         "
    C$ = INPUT$(1)
    IF UCASE$(C$) = "A" THEN CALL ABOUT
    IF UCASE$(C$) = "L" THEN CALL LOGIN
    IF UCASE$(C$) = "R" THEN CALL REGISTER
    IF UCASE$(C$) = "E" THEN EXIT DO
LOOP WHILE UCASE$(C$) <> "E"
END


SUB REGISTER
CLS
COUNT = 0
COLOR 5
OPEN "ACCOUNTS.TXT" FOR INPUT AS #1
LOCATE 5, 5: INPUT "USERNAME"; N$
LOCATE 6, 5: INPUT "PASSWORD"; P$
LOCATE 7, 5: INPUT "ADRESS:"; ADDR$
LOCATE 8, 5: INPUT "PHONE:"; PHONE$
LOCATE 9, 5: INPUT "EMAIL:"; EMAIL$

WHILE NOT EOF(1)
    INPUT #1, USER$, PASS$
    IF USER$ = N$ THEN COUNT = 1
WEND
IF COUNT = 1 THEN
    CLS
    PRINT "NAME WITH SIMILIAR NAME ALREADY FOUND.."
    PRINT "TRY "; N$ + "145"; ","; N$ + STR$(RND * 1000); "."
END IF
CLOSE #1
IF COUNT <> 1 THEN
    OPEN "ACCOUNTS.TXT" FOR APPEND AS #2
    OPEN "DATA.TXT" FOR APPEND AS #3
    WRITE #2, N$, P$
    WRITE #3, N$, ADDR$, PHONE$, EMAIL$
    CLOSE #2, #3
    CLS
    PRINT "SUCESSFULLY REGISTERED"
END IF
PRINT "PRESS ANY KEY TO GO BACK.."
X$ = INPUT$(1)
END SUB


SUB LOGIN
COLOR 14
CLS
SUCESS = 0
INPUT "REGISTERED USERNAME"; RUSR$
INPUT "PASSWORD:"; PASS$
OPEN "ACCOUNTS.TXT" FOR INPUT AS #1
WHILE NOT EOF(1)
    INPUT #1, A$, B$
    REM REMEMBERING THE CURRENT LOGGED ON USER.
    IF A$ = RUSR$ AND B$ = PASS$ THEN
        OPEN "CURRENT.TXT" FOR OUTPUT AS #7
        SUCESS = 1
        WRITE #7, RUSR$, PASS$
        CLOSE #7
    END IF
WEND
CLOSE #1

COLOR 4
IF SUCESS = 1 THEN
    CLS
    PRINT "SUCESSFULLY LOGGED ON.."
    OPEN "DATA.TXT" FOR INPUT AS #4
    WHILE NOT EOF(4)
        INPUT #4, NAME$, ADDR$, PHONE$, EMAIL$
        IF NAME$ = RUSR$ THEN GOTO DONE
    WEND
    DONE:
    PRINT "PRESS ANY KEY START REAL ACCOUNT LOGGING.."
    X$ = INPUT$(1)
    CLOSE #4
    CALL HOME

END IF

 
IF SUCESS <> 1 THEN
    CLS
    PRINT "ACCOUNT NOT RECOGNIZED.."
    PRINT "TRY REGISTERING..."

    PRINT "PRESS ANY KEY TO GO BACK..."
    X$ = INPUT$(1)
    CLOSE #4
END IF

END SUB


SUB HOME
COLOR 6
OPEN "CURRENT.TXT" FOR INPUT AS #10
INPUT #10, NAME$, PASSWORD$
CLOSE #10
HERE:
CLS
PRINT " ___________"
PRINT "|___________|Q|", NAME$, "MESSAGES(M)", "EXIT(E)", "SETTINGS(S)"
PRINT
PRINT
OPEN "DATA.TXT" FOR INPUT AS #9
DO
    INPUT #9, DN$, DA$, DP$, DE$
LOOP WHILE DN$ <> NAME$
CLOSE #9
PRINT "NAME:"; DN$
PRINT "ADRESS:"; DA$
PRINT "PHONE:"; DP$
PRINT "EMAIL:"; DE$
PRINT: PRINT
PRINT "|------------------WRITE A NEW POST(W)-------------------------|"
PRINT: PRINT:
PRINT "|---------------------POSTS BY:"; DN$; "------------------------|"

REM PRINTIING POSTS
OPEN "POSTS.TXT" FOR INPUT AS #13
WHILE NOT EOF(13)
    INPUT #13, EN$, ED$, EP$
    IF EN$ = DN$ THEN PRINT: PRINT EN$, ED$, EP$
WEND
CLOSE #13

CMMND$ = INPUT$(1)


IF UCASE$(CMMND$) = "S" THEN CALL SETTINGS
IF UCASE$(CMMND$) = "Q" THEN CALL SEARCH
IF UCASE$(CMMND$) = "W" THEN CALL POST
IF UCASE$(CMMND$) = "M" THEN CALL MESSAGE
IF UCASE$(CMMND$) <> "E" THEN GOTO HERE

PRINT
PRINT
PRINT "PRESS ANY KEY TO GO BACK..."
X$ = INPUT$(1)
END SUB



SUB POST

REM POST DETAILS CONTAINS NAME,DATE AND TIME AND POST.
REM GETTING CURRENT LOGGED ON USER INFORMATION.
OPEN "CURRENT.TXT" FOR INPUT AS #3
INPUT #3, CU$, CP$
CLOSE #3

REM DELETE CURRENT USERS PREVIOUS POSTS..:)
OPEN "POSTS.TXT" FOR INPUT AS #1
OPEN "POSTSTEMP.TXT" FOR OUTPUT AS #2
WHILE NOT EOF(1)
    INPUT #1, PA$, PD$, PP$
    IF PA$ <> CU$ THEN WRITE #2, PA$, PD$, PP$
WEND
CLOSE #1, #2
KILL "POSTS.TXT"
NAME "POSTSTEMP.TXT" AS "POSTS.TXT"

REM NOW WRITING THE CONTENTS.
CLS
LOCATE 3, 1
PRINT "..THE PREVIOUS POST WILL BE REPLACED BY THE CURRENT POST.."
PRINT
PRINT
PRINT "WRITE YOUR POST(LESS THAN 225 CHARACTERS).."
LINE INPUT ; POSTMSG$
OPEN "POSTS.TXT" FOR APPEND AS #4
WRITE #4, CU$, DATE$ + "," + TIME$, POSTMSG$
CLOSE #4
PRINT: PRINT
PRINT "PRESS ANY KEY TO GO BACK..."
X$ = INPUT$(1)
END SUB


SUB MESSAGE

REM MESSAGE CONTAINS RECEIVER,SENDER,DATE AND TIME,AND MESSAGE.
REM GETTING USER INFORMATION
OPEN "CURRENT.TXT" FOR INPUT AS #10
INPUT #10, MN$, MP$
CLOSE #10

MSG:
CLS
PRINT "VIEW MESSAGES(V) WRITE MESSAGES(W)"
X$ = INPUT$(1)

REM VIEWING MESSAGES.
IF X$ = "V" THEN
    OPEN "MESSAGES.TXT" FOR INPUT AS #1

    DELMSG = 0
    
    PRINT "DELETE SEEN MESSAGES AUTOMATICALLY(Y/N)?"
    DELCON$ = INPUT$(1)
    IF UCASE$(DELCON$) = "Y" THEN
        DELMSG = 1
    END IF
                
    CLS
                
    WHILE NOT EOF(1)
        INPUT #1, VR$, VS$, VDT$, VMSG$
      
        IF VR$ = MN$ THEN
            CLS
            
            PRINT: PRINT: PRINT: PRINT
            
            CLS
            PRINT "RECEIVER:"; VR$
            PRINT "SENDER:"; VS$
            PRINT "DATE AND TIME OF MESSAGE SENT:"; VDT$
            PRINT "MESSAGE:"
            PRINT VMSG$
            PRINT
            PRINT
            PRINT "PRESS ANY KEY FOR NEXT.."
            
            
            Y$ = INPUT$(1)
        END IF
        
    WEND
    
    CLOSE #1
     
    REM USER CHOOSE TO DELETE ALL SEEN MESSAGES.
    IF DELMSG = 1 THEN
        OPEN "MESSAGES.TXT" FOR INPUT AS #13
        OPEN "MSG0TEMP.TXT" FOR OUTPUT AS #14
         
        WHILE NOT EOF(13)
            INPUT #13, DELREC$, DELSEND$, DELDT$, DELMSG$
            IF MN$ <> DELREC$ THEN
                WRITE #14, DELREC$, DELSEND$, DELDT$, DELMSG$
            END IF
        WEND

        CLOSE #13, #14
        KILL "MESSAGES.TXT"
        NAME "MSG0TEMP.TXT" AS "MESSAGES.TXT"
     
    END IF


END IF




REM WRITING MESSAGES.
IF X$ = "W" THEN
    OPEN "MESSAGES.TXT" FOR APPEND AS #1
    CLS
    PRINT "----WRITE MESSAGE-----"
    LOCATE 7, 2
    PRINT "...MAKE SURE THE RECEIVER EXITS..."
    INPUT "ENTER THE NAME OF RECEIVER:"; RECEIVERX$
    LINE INPUT "ENTER YOUR MESSAGE:(NOT GREATER THAN 225 CHARACTERS):"; MSGX$
    WRITE #1, RECEIVERX$, MN$, DATE$ + "," + TIME$, MSGX$
    CLOSE #1
    PRINT: PRINT , "...DELIVERED...."
END IF
 
REM IF X$ <> "E" THEN GOTO MQUIT

MQUIT:
PRINT: PRINT
PRINT "PRESS ANY KEY TO CONTINUE.."
Z$ = INPUT$(1)
END SUB



SUB SEARCH

REM GETTING CURRENT LOGGED ON USER INFORMATION.
OPEN "CURRENT.TXT" FOR INPUT AS #9
INPUT #9, SU$, SP$
CLOSE #9

CLS
LOCATE 1, 10
PRINT "..JUST EASILY DISCOVER FRIENDS AND WORKGROUPS.."
LOCATE 3, 5
PRINT "TYPE WHOM DO YOU WANT TO SEARCH?"
LOCATE 10, 5
PRINT "...EXPLORE MORE WITH US..."
LOCATE 4, 6
INPUT ; SQUERY$
OPEN "DATA.TXT" FOR INPUT AS #7
DATFOUND = 0
WHILE NOT EOF(7)
    INPUT #7, DDN$, DDAD$, DDPH$, DDMAIL$
    IF DDN$ = SQUERY$ THEN
        CLS
        DATFOUND = 1
        PRINT "NAME:"; DDN$
        PRINT "ADDRESS:"; DDAD$
        PRINT "PHONE:"; DDPH$
        PRINT "EMAIL:"; DDMAIL$
        PRINT
         PIC$ = INPUT$(1)
    END IF

WEND

IF DATFOUND <> 1 THEN
    CLS
    PRINT: PRINT: PRINT: PRINT
    PRINT "....DATA NOT FOUND.."
    PRINT: PRINT: PRINT: PRINT
    PRINT "   ....TRY REGISTERING THE ACCOUNT..."
END IF

CLOSE #7
LOCATE 15, 2
PRINT "PRESS ANY KEY TO CONTINUE.."
Z$ = INPUT$(1)

END SUB



SUB ABOUT
CLS
COLOR 5
PRINT , , "ABOUT"
PRINT "Created by : ANIL BK(anilforextra),2018"
PRINT:
PRINT , "....PRESS ANY KEY TO GO BACK.."
Z$ = INPUT$(1)
END SUB



SUB SETTINGS
CLS
REM GETTING CURRENT LOGGED ON USER INFORMATION.
OPEN "CURRENT.TXT" FOR INPUT AS #14
INPUT #14, KNAME$, KPASS$
CLOSE #14

LOCATE 3, 10
PRINT "SETTINGS.."

PRINT: PRINT: PRINT: PRINT
PRINT "CHANGE NAME AND OTHER DETAILS(C)"
PRINT "DELETE ACCOUNT PERMANENTLY(D)"
PRINT "CHANGE ACCOUNT PASSWORD(P)"
PRINT
PRINT "EXIT(ANY OTHER KEY)"
PRINT
PRINT

SET$ = INPUT$(1)


REM CHNAGING DETAILS.
IF UCASE$(SET$) = "C" THEN
    CLS
    PRINT "ITS LIKE CREATING A NEW ACCOUNT HOWEVER  YOUR MESSAGES AND POSTS REMAIN THE SAME.."
    INPUT "USERNAME"; CDU$
    INPUT "ADDRESS"; CDA$
    INPUT "PHONE"; CDP$
    INPUT "EMAIL"; CDE$


    PRINT "EDITING THE RECORD FROM MAIN DATABASE..."
    OPEN "ACCOUNTS.TXT" FOR INPUT AS #48
    OPEN "CDACC.TXT" FOR OUTPUT AS #49

    WHILE NOT EOF(48)
        INPUT #48, CDACCO$, CDPASSO$
        IF CDACCO$ = KNAME$ THEN
            WRITE #49, CDA$, KPASS$
        ELSE
            WRITE #49, CDACCO$, CDPASSO$
        END IF
    WEND
    CLOSE #48, #49
    KILL "ACCOUNTS.TXT"
    NAME "CDACC.TXT" AS "ACCOUNTS.TXT"
    PRINT "DONE[X]"


    PRINT "EDITING ADRESS,PHONE AND EMAIL"
    OPEN "DATA.TXT" FOR INPUT AS #50
    OPEN "CDDATA.TXT" FOR OUTPUT AS #51

    WHILE NOT EOF(50)
        INPUT #50, CDACCO$, CDAD$, CDPH$, CDEM$
        IF CDACCO$ = KNAME$ THEN
            WRITE #51, CDU$, CDA$, CDP$, CDE$
        ELSE
            WRITE #51, CDACCO$, CDAD$, CDPH$, CDEM$
        END IF
    WEND
    CLOSE #50, #51
    KILL "DATA.TXT"
    NAME "CDDATA.TXT" AS "DATA.TXT"
    PRINT "DONE[X]"


    PRINT "EDITING THE NAME FROM MESSAGE FORM.."
    OPEN "MESSAGES.TXT" FOR INPUT AS #78
    OPEN "MSGTEST.TXT" FOR OUTPUT AS #79

    WHILE NOT EOF(78)
        INPUT #78, EDITR$, EDITS$, EDITDT$, EDITMSG$

        IF EDITR$ = KNAME$ THEN
            WRITE #79, CDU$, EDITS$, EDITDT$, EDITMSG$
        ELSE
            WRITE #79, EDITR$, EDITS$, EDITDT$, EDITMSG$
        END IF

    WEND

    CLOSE #78, #79
    KILL "MESSAGES.TXT"
    NAME "MSGTEST.TXT" AS "MESSAGES.TXT"
    PRINT "DONE[X]"

    PRINT "EDITING FROM THE POSTS DEVELOPMENT REGION.."
    OPEN "POSTS.TXT" FOR INPUT AS #98
    OPEN "POTS.TXT" FOR OUTPUT AS #99

    WHILE NOT EOF(98)
        INPUT #98, PEN$, PED$, PEP$
        IF PEN$ = KNAME$ THEN
            WRITE #99, CDU$, PED$, PEP$
        ELSE
            WRITE #99, PEN$, PED$, PEP$
        
        END IF
    WEND

    CLOSE #98, #99
    KILL "POSTS.TXT"
    NAME "POTS.TXT" AS "POST.TXT"
    PRINT "DONE[X]"

    PRINT "..DATA EDITED.."




END IF



REM CHANGNG THE PASSWORD.
IF UCASE$(SET$) = "D" THEN
    CLS
    PRINT
    PRINT
    PRINT "ARE YOU SURE TO DELETE YOUR ACCOUNT AND EVERYTHING RELATED TO YOU?"
    PRINT "..THIS INCLUDES YOUR PERSONAL DETAILS,YOUR POSTS,MESSAGES AND YOU NO LONGER COULD BE FOUND BY OTHERS.."
    PRINT
    PRINT "ACCOUNT NAMED:"; KNAME$; " WILL BE LOST FOREVER!(A LONG TIME!)"
    PRINT
    PRINT
    INPUT "PRESS (Y/N) TO CONTINUE.."; KONT$

    IF UCASE$(KONT$) = "Y" THEN
        REM ACTIVATE DELETE COMMAND MODE.
        CLS
        PRINT "YOU ARE ABOUT TO DELETE YOUR ACCOUNT.."
        INPUT "ENTER PASSWORD TO CONTINUE ACCOUNT DELETION."; DPASS$

        IF DPASS$ = KNAME$ THEN
            REM DELETING ALL FILES.
    
            REM DELETE FROM ACCOUNTS.
            PRINT "DELETING MAIN DATA.."
            OPEN "ACCOUNTS.TXT" FOR INPUT AS #10
            OPEN "ACCTEMP.TXT" FOR OUTPUT AS #11
            WHILE NOT EOF(10)
                INPUT #10, DELUSER$, DELPASS$
                IF DELUSER$ <> KNAME$ AND DELPASS$ <> KPASS$ THEN WRITE #11, DELUSER$, DELPASS$
            WEND
        
            CLOSE #10, #11
            KILL "ACCOUNTS.TXT"
            NAME "ACCTEMP.TXT" AS "ACCOUNTS.TXT"
            PRINT "DONE[X]"
    
    
            REM DELETING DATA.
            PRINT "DELETING DETAILS.."
            OPEN "DATA.TXT" FOR INPUT AS #13
            OPEN "DATATEMP.TXT" FOR OUTPUT AS #14
            WHILE NOT EOF(13)
                INPUT #13, BRUSER$, BRPASS$, XX$, ZZ$
                IF BRUSER$ <> KNAME$ THEN WRITE #14, BRUSER$, BRPASS$, XX$, ZZ$
            WEND
        
            CLOSE #13, #14
            KILL "DATA.TXT"
            NAME "DATATEMP.TXT" AS "DATA.TXT"
            PRINT "DONE[X]"
    
            REM DELETING MESSAGE.
            PRINT "DELETING MESSAGES.."
            OPEN "MESSAGES.TXT" FOR INPUT AS #17
            OPEN "MSGTEMP.TXT" FOR OUTPUT AS #18
            WHILE NOT EOF(17)
                INPUT #17, MSGU$, MSGP$, MSGT$, MSGM$
                IF MSGU$ <> KNAME$ THEN WRITE #18, MSGU$, MSGP$, MSGT$, MSGM$
            WEND

            CLOSE #17, #18
            KILL "MESSAGES.TXT"
            NAME "MSGTEMP.TXT" AS "MESSAGES.TXT"
            PRINT "DONE[X]"


            REM DELETING POSTS
            PRINT "DELETING POSTS.."
            OPEN "POSTS.TXT" FOR INPUT AS #21
            OPEN "POSTSTEMP.TXT" FOR OUTPUT AS #22
            WHILE NOT EOF(21)
                INPUT #21, PON$, POD$, POP$
                IF PON$ <> KNAME$ THEN WRITE #22, PON$, POD$, POP$
            WEND
            CLOSE #21, #22
            KILL "POSTS.TXT"
            NAME "POSTSTEMP.TXT" AS "POSTS.TXT"
            PRINT "DONE[X]"
            PRINT
            PRINT "ACCOUNT DELETION COMPLETE!!!"
            PRINT "..RESTART THE PROGRAM FOR CHANGES TO TAKE PLACE.."
            K$ = INPUT$(1)
            GOTO DQUIT
        END IF

    END IF

END IF


REM CHANGE ACCOUNT PASSWORD
IF UCASE$(SET$) = "P" THEN
    INPUT "ENTER YOUR CURRENT PASSWORD TO CONFIRM:"; PXS$

    IF PXS$ = KPASS$ THEN
        INPUT "ENTER NEW PASSWORD:"; NXP$
        OPEN "ACCOUNTS.TXT" FOR INPUT AS #25
        OPEN "ACCOTMP.TXT" FOR OUTPUT AS #26
        WHILE NOT EOF(25)
            INPUT #25, CNAM$, CPASS$
            IF CNAM$ <> KNAME$ THEN WRITE #26, CNAM$, CPASS$
            IF CNAM$ = KNAME$ THEN WRITE #26, KNAME$, NXP$
        WEND
        CLOSE #25, #26
        KILL "ACCOUNTS.TXT"
        NAME "ACCOTMP.TXT" AS "ACCOUNTS.TXT"
        PRINT
        PRINT
        PRINT " ..PASSWORD SUCESSFULLY CHANGED.."
    ELSE
        PRINT "..PASSWORD INCORRECT.UNAUTHORIZED ACESS.."
    END IF

    PRINT
    PRINT

    PRINT "..PRESS ANY KEY TO CONTINUE.."
    KKK$ = INPUT$(1)
END IF

PRINT: PRINT: PRINT "..PRESS ANY KEY TO GO BACK.."
Z$ = INPUT$(1)

DQUIT:
END SUB
